language: java
jdk:
  - openjdk11
services:
  - postgresql
  - docker
env:
  - global:
      - secure: "hhuatWEa1s7wQ3f4SZSmNG/Hhqk4RJuL8GSHpkpz+0Cx2jC0z14fg+eVM4r2WCLSDA8gYCNk9SPUK/efZFb10Ln+i1pV3dR/OAiO+AEWoPgbvYulbnxZZofXkKXR4VIWqabtBDVAGdx2K7gf2cZyrmneU+gmaegAn95nIi0xaJ49XzzcAcVa9FZJRR3wacBJvHVmQ2YaK00FgqKNtt74vjz10u7vIoYS3OSBW46sjTnAijpn41L6aPz67tqE2BNvAgU1g4LwXKTPFdca2W4jE4tF4ojasUHbngVVylSfsCb1BnMLSZZHXwPSBzQT59Zpc6EEpuaZxO/P/sSR1n4Fkur9FbDHW1tv3sWHN1UQsQLNug8uABve753r1Z4xG5QH5TApOB7yrpDA+W2+OjBEAz6OXZxFFVYzPEYYiFoEeq3HlKp6w9zieYzILT4Xr/5W7FQCcEvsAg5uZoe2E8xAK4CuUZpMjQCNcNvkIUz8K0x97/3o2Bjz+6G5kh1oTabCBUFWA12WXxNrzYtBlDHR40jY9r9rmwWWkTgYOWVLquzAZim6jwmC5Z+CeXdp3pPk9gqwlOSLsWBsAAwnGmvQN9XBao+z7+IWYmG0Q6gLDa+HWN63XYD1N6no4I0L8SPDaza7xBHadDVY8XgUXVZw0xeZkEgn95R7R6U9Qcn6XUc="
      - secure: "pUlGNz13tAN6DdUuzvCqzOqQgX28P+uRTZyD2ndYe+A7I7UCLtjVqZBPRo2rL2W6mBPvTthMvO5iVAZblZEKukg+Kk+Wu4DCOMps0uvK2CY7HEe0Jf6I9LkUoVIjyuxzhCPI/PCpSw1bdZumBFo3yOjyhWRt9wcEQBgyq3CrvxYLYsFq8Ne6u3ClMSFDLCZ+BVj5TZDVgc9/cKM1KoefmBXjdL6VT2bPzq3XW9FRx+wYWdBZoZKRWuogMjXuzl9oyYq5FLZEQYD2eCuPLGEZ9PYuZKGq2blQ+Bc2VFazsgsnmDu3+tP7dqt8KfQcZAV993Tv8qzP6ACJ9ztoFk6egVxm7aEpZigh9T1mN5lxMS/um4iAL8hUH/I9L4HfE2uh3w5vXlr1GbZdBGcYt9iYc9nnyVUm/1CgpkZy9U3W+w6whCChKgDisXOCpl23vrGAHGyRGKrbAqD7CqZ3b+Zgjhu25Sk3E6UFk3447d8FH05brr792FgXF76LaQTifTKe0lGFIWQ1yaJLXog3oxdIZWQZuvJXPZzeTjbX19i0VwX0fSg6lqA4LbY8PnEgG2vrCgzSgZS0E5/PtrJOvix2y7Pe9hkIVmKfWlzvey04UTmgEZ8NEtl/S9Bh7KTdbr+QJqWIZEWZOmKAEzzpfATkChOznpoVn35pjIS3OCWA8Xo="
      - secure: "TKC6ZHVrTGtO0DfRGWtilMVW9qpyCCg19+OXDKaoGW1UHq7NYsucvmh5ATOgqKDufktW//KX2BXHJEtUHodjtHD5rsLCD03hbeHi8eHYn4ZOODX11o9yPEhIAOJgt/vPEhyvLLHHsMw1gt3X9oUCXPlKLO5thTxy7PYs5FM7pVd9q/LGEMt3aldDDwAS4d7pbv3o6HrBheauVepFTiViM4PomMV1T62wCMarAMU+S3zoS2e2cd9XOGuksFV67e6jAoyQwf0kuSHXqmTW9C6UGgRLK79FhbbYIBTnt4DAyntA5d3JuGAgWfc1mGug3KBb/AvJbEUjihI8n3nXel7ZmDBlKKfEQZsOtALt4eKHOp2CHEXW3KaDsRPIFE8aToDYGfM6FWKBXlLLCdWdp5+sLmQD2deV2TvPW4+RZCWwSCGn3AjhceaRKH3Nwr/HISEN9/1hWFiharINfDCvdst616PVtj9yvV5m8w9/wIQubRlti1APBb+8qYNlPmP3S2ysgLhl0zL0uo8/PTy6uA6+D/z6Km6RQ+2WtNIb0DAvTHiyXLHaOAkFKz2sbL4mK9Ypx4fE+thx09ZLUsFX3+wkAKdE/QShoS/RskFom6HwyOCkQ/IkEyNaqfnMPHq1wsrtsGJS7einaZ6UL71Q6lS+1v4JmtF2wnwy45dCBqumE04="
      - secure: "pVPTcnLLMWM6pkor55bmBBhn7AY3xF8H6iUp8AljRnLJPNOZFEaKylkg39oC+fZ8eGQaoqF6Xjumtup4RD7UFWjP2uVXW5aO1pt35guM3kAfz8mtE7ReHffyCDprSjHW7uG00Gu5zNuyqm4N1GcvuQC/PPqcelCZa4ae7IwsOj18+rJrnnjdfiJEEXl0VqCNwOA0pVI6MVYhBNZ54uWBwXuNsp6cr3n9qWljZcGdYxq6+H4znqEehUyFVmx6pacR7HtyJ1J3LRk4KdM06V4R0OA6s7j90LowyHOEn7Nkte/pD+FPk9om9VcScrZhzEzAbCrCRD4SWg4pZAbj+1YLgwTFOa9pEJ2gFkjEWbey+lA0zVq+bVW4jLEngrFVhlorln2nFH31hpZUQDWqLQtT+6y7h/CFROntoMfTnS9VDQKwIo4Z9stkvcLweU1AfHgB6MqMkj6Zr3nGzcD5Ykmj8t0NLgjkasS0okxMuLKw1VohRnmYKWkETf2DOkjD7HFH4OhMezByvNK7vn2ZejbXTZwJV94ismvUSch2lLhvvlLJPL0nArtdSLAP03d7jaJq0ExMNAbiEz+ps8C+glRkz8HVn2cpIZ/kameJ2qlGrTEuXbE6Y93sRvaE6zeaqxYIgczm9qzzRHnlagkemV0X/wCfj5d+eL8tGyjmemJDjAo="
      - secure: "u3/y4QyogVl7dpJ+d/kPTvR31kwpDqWfZe7yzKCjkaWTB5Barc/oyOl2apGJ1uAJXjZnnLXEsN05CdvnC3sFtrPUBQUyydPCwHr+l8DPGnN98/v2Qh9dNWsGaUN8ZTlsQn9L5GjVBfp3s0i2KvobJymNOXCbHlG4+NLzCPlTsMPPN8DOSup7ngy3pCAsOvUcJIy1cEIGMV7hT0iHESGNczWba85D62nlWwP/Q8a279Y0t7AArmh0k7zetniNLHt6bKJqqrJephSaTKaMz5vUuKi7TUwv1w/io76GWLUySpOdkUwllXRS5m6RkVDU9SCMENz3YXmUSfo2AgxdcDUOFE/P86+cdJiZj3iU+sKNhJGLTInNPrhInhzssghUYeUj111BpWfESYDqkWdIPreq1btSqRzUt6VaXHwkigds97/puNh6OM5Cot4845muB0flbsYbCeBhc+PZlzbNVpP3jbmGRz5rUAGvdn8P1H8i1ljjZFYJ5htHCcth46qEEx+Wfk6qf5q7IbXudcqnonpgA0j6Uf8gWVhltitOrTY3H/UcIPCqEHerCV/AjtSdRhD32hd9Ex+qHFycaQTS8TWtlnZdHBLnxYISxf1pbU5Iqn01hxjSbMhRQTg79VpYmM8t7jIQe7HhUinOxAg6e3zpwwqsDKjNiHMp5sKAMfWQPuM="
cache:
  directories:
    - $HOME/.m2
before_script:
  - psql -c "CREATE USER $USERNAME WITH PASSWORD '$PASSWORD';" -U postgres
  - psql -c "ALTER ROLE $USERNAME SUPERUSER"
  - psql -c "CREATE DATABASE $DB;" -U postgres
install: true
script:
  - "mvn clean flyway:migrate jooq-codegen:generate install"
after_success:
  -  docker build -t $DOCKER_USERNAME/my_example_app .
  - if [ "$TRAVIS_BRANCH" == "master" ]; then echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin; docker push $DOCKER_USERNAME/my_example_app; fi
